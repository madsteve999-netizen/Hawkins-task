<!DOCTYPE html>
<html lang="ru">

<head>
    <link rel="icon" type="image/png" sizes="32x32" href="/favicon-32x32.png">
    <link rel="icon" type="image/png" sizes="16x16" href="/favicon-16x16.png">
    <link rel="apple-touch-icon" sizes="180x180" href="/apple-touch-icon.png">
    <link rel="manifest" href="/site.webmanifest">

    <meta name="theme-color" content="#000000">
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
    <title>Stranger Things Task Manager</title>
    <script src="https://cdn.jsdelivr.net/npm/sortablejs@1.15.0/Sortable.min.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/@supabase/supabase-js@2"></script>
    <!-- vConsole for Mobile Debugging -->
    <script src="https://unpkg.com/vconsole@latest/dist/vconsole.min.js"></script>
    <script>
        // Initialize vConsole
        window.addEventListener('load', function () {
            var vConsole = new window.VConsole();
            console.log('vConsole initialized');
        });
    </script>
    <link rel="stylesheet" href="style.css">
</head>

<body>

    <div class="bg-layer" id="bg-layer"></div>
    <div class="overlay"></div>
    <div class="scanlines"></div>
    <div id="lightning"></div>
    <div id="spores-container"></div>

    <div id="app-ui">
        <div id="workspace">
            <div class="header">
                <h2 id="main-header" onmousedown="startInvocation()" onmouseup="stopInvocation()"
                    onmouseleave="stopInvocation()" ontouchstart="startInvocation(event)" ontouchend="stopInvocation()">
                    –°–ü–ò–°–û–ö –ó–ê–î–ê–ß</h2>
            </div>

            <!-- –ë–õ–û–ö –†–ê–î–ò–û -->
            <div class="control-box" id="radio-control-box">
                <div class="radio-header collapsed" onclick="toggleRadioPanel()">
                    üì° –ß–ê–°–¢–û–¢–´ –≠–§–ò–†–ê
                    <svg viewBox="0 0 24 24">
                        <path d="M6 9l6 6 6-6" />
                    </svg>
                </div>
                <div class="radio-content hidden">
                    <div class="channel-row">
                        <div class="ch-btn active" onclick="setCh(0)">1</div>
                        <div class="ch-btn" onclick="setCh(1)">2</div>
                        <div class="ch-btn" onclick="setCh(2)">3</div>
                        <div class="ch-btn" onclick="setCh(3)">4</div>
                        <div class="ch-btn" onclick="setCh(4)">5</div>
                    </div>
                    <div class="channel-row">
                        <div class="ch-btn" onclick="setCh(5)">6</div>
                        <div class="ch-btn" onclick="setCh(6)">7</div>
                        <div class="ch-btn" onclick="setCh(7)">8</div>
                        <div class="ch-btn" onclick="setCh(8)">9</div>
                        <div class="ch-btn" onclick="setCh(9)">10</div>
                    </div>
                    <button class="play-btn" id="play-btn" onclick="toggleAudio()">–ù–ê–ß–ê–¢–¨ –≠–§–ò–†</button>
                </div>
            </div>

            <!-- –ë–õ–û–ö –ü–û–ú–û–î–û–†–û -->
            <div class="control-box">
                <!-- MODE SWITCHER -->
                <div class="mode-switch">
                    <span id="mode-timer" class="active" onclick="switchMode('timer')">TIMER</span> | <span
                        id="mode-chrono" onclick="switchMode('stopwatch')">CHRONO</span>
                </div>

                <!-- 1. –¶–ò–§–†–´ –¢–ê–ô–ú–ï–†–ê (–≠–¢–ê–ñ 1) -->
                <div class="timer-display-row">
                    <div class="timer-digits" id="timer">25:00</div>
                </div>

                <!-- 2. –û–°–ù–û–í–ù–´–ï –ö–ù–û–ü–ö–ò (–≠–¢–ê–ñ 2) -->
                <div class="timer-controls-row">
                    <button class="t-btn-text" id="t-start-btn" onclick="toggleTimer()">–°–¢–ê–†–¢</button>
                    <button class="t-btn-text" onclick="fullReset()">–°–ë–†–û–°</button>
                    <button class="t-btn-text" onclick="openNotes()">–ó–ê–ú–ï–¢–ö–ò</button>
                </div>

                <!-- 3. –ò–ö–û–ù–ö–ò (–≠–¢–ê–ñ 3 - –†–û–í–ù–ê–Ø –°–ï–¢–ö–ê) -->
                <div class="timer-icons-row">
                    <!-- –°–ª–µ–¥. —ç—Ç–∞–ø -->
                    <button class="t-btn-icon" title="–°–ª–µ–¥. —ç—Ç–∞–ø" onclick="forceNextStep()">
                        <svg viewBox="0 0 24 24">
                            <path d="M5 4l10 8l-10 8V4z" />
                            <rect x="17" y="4" width="2" height="16" />
                        </svg>
                    </button>
                    <!-- –í–µ–∫–Ω–∞ -->
                    <button class="t-btn-icon active" id="vecna-toggle" onclick="toggleVecna()">
                        <svg viewBox="0 0 24 24">
                            <path d="M18 8A6 6 0 0 0 6 8c0 7-3 9-3 9h18s-3-2-3-9M13.73 21a2 2 0 0 1-3.46 0" />
                        </svg>
                    </button>
                    <!-- –≠–∫—Ä–∞–Ω -->
                    <button class="t-btn-icon" id="wakelock-toggle" onclick="toggleWakeLock()">
                        <svg id="icon-screen" viewBox="0 0 24 24">
                            <rect x="5" y="2" width="14" height="20" rx="2" ry="2" stroke="currentColor" fill="none"
                                stroke-width="2" />
                            <line x1="2" y1="2" x2="22" y2="22" stroke="currentColor" stroke-width="2" />
                        </svg>
                    </button>

                    <!-- –°–∂–µ—á—å –ê—Ä—Ö–∏–≤ -->
                    <button class="t-btn-icon" title="–°–ñ–ï–ß–¨ –ê–†–•–ò–í" onclick="openBurnModal()">
                        <svg viewBox="0 0 24 24" style="fill: currentColor; stroke: none;">
                            <path
                                d="M12 23c-3.037 0-5.5-2.463-5.5-5.5 0-2.702 1.796-4.577 2.77-5.478.294-.272.53-.48.73-.663V8.5c0-.276.224-.5.5-.5s.5.224.5.5v2.859c.2.183.436.391.73.663.974.901 2.77 2.776 2.77 5.478 0 3.037-2.463 5.5-5.5 5.5zm0-1c2.485 0 4.5-2.015 4.5-4.5 0-2.235-1.521-3.843-2.395-4.661-.318-.297-.602-.562-.855-.805-.253.243-.537.508-.855.805C11.521 13.657 10 15.265 10 17.5c0 2.485 2.015 4.5 4.5 4.5zM9 11.5c0 .276-.224.5-.5.5s-.5-.224-.5-.5c0-1.93-1.57-3.5-3.5-3.5-.276 0-.5-.224-.5-.5s.224-.5.5-.5c2.481 0 4.5 2.019 4.5 4.5zm11-4c0 .276-.224.5-.5.5s-.5-.224-.5-.5c0-1.93-1.57-3.5-3.5-3.5-.276 0-.5-.224-.5-.5s.224-.5.5-.5c2.481 0 4.5 2.019 4.5 4.5zM7 6.5c0 .276-.224.5-.5.5s-.5-.224-.5-.5C6 4.019 7.519 2.5 10 2.5c.276 0 .5.224.5.5s-.224.5-.5.5C8.07 3.5 7 4.57 7 6.5z" />
                        </svg>
                    </button>

                    <!-- –ö–Ω–æ–ø–∫–∞ —á–∞—Å–æ–≤ –¥–ª—è —Å–∫—Ä—ã—Ç–∏—è –Ω–∞—Å—Ç—Ä–æ–µ–∫ -->
                    <button class="t-btn-icon" id="timer-settings-toggle" onclick="toggleTimerSettings()">
                        <svg viewBox="0 0 24 24">
                            <circle cx="12" cy="12" r="10" />
                            <polyline points="12 6 12 12 16 14" />
                        </svg>
                    </button>

                    <!-- –ù–∞—Å—Ç—Ä–æ–π–∫–∏ (–®–µ—Å—Ç–µ—Ä–µ–Ω–∫–∞) -->
                    <button class="t-btn-icon" onclick="openSettingsModal()">
                        <svg viewBox="0 0 24 24" style="fill: currentColor; stroke: none;">
                            <path
                                d="M19.14,12.94c0.04-0.3,0.06-0.61,0.06-0.94c0-0.32-0.02-0.64-0.07-0.94l2.03-1.58c0.18-0.14,0.23-0.41,0.12-0.61 l-1.92-3.32c-0.12-0.22-0.37-0.29-0.59-0.22l-2.39,0.96c-0.5-0.38-1.03-0.7-1.62-0.94L14.4,2.81c-0.04-0.24-0.24-0.41-0.48-0.41 h-3.84c-0.24,0-0.43,0.17-0.47,0.41L9.25,5.35C8.66,5.59,8.12,5.92,7.63,6.29L5.24,5.33c-0.22-0.08-0.47,0-0.59,0.22L2.74,8.87 C2.62,9.08,2.66,9.34,2.86,9.48l2.03,1.58C4.84,11.36,4.8,11.69,4.8,12s0.02,0.64,0.07,0.94l-2.03,1.58 c-0.18,0.14-0.23,0.41-0.12,0.61l1.92,3.32c0.12,0.22,0.37,0.29,0.59,0.22l2.39-0.96c0.5,0.38,1.03,0.7,1.62,0.94l0.36,2.54 c0.05,0.24,0.24,0.41,0.48,0.41h3.84c0.24,0,0.44-0.17,0.47-0.41l0.36-2.54c0.59-0.24,1.13-0.56,1.62-0.94l2.39,0.96 c0.22,0.08,0.47,0,0.59-0.22l1.92-3.32c0.12-0.22,0.07-0.47-0.12-0.61L19.14,12.94z M12,15.6c-1.98,0-3.6-1.62-3.6-3.6 s1.62-3.6,3.6-3.6s3.6,1.62,3.6,3.6S13.98,15.6,12,15.6z" />
                        </svg>
                    </button>
                </div>

                <!-- 5. –ù–ê–°–¢–†–û–ô–ö–ò (–°–ö–†–´–¢–´–ï –ü–û –£–ú–û–õ–ß–ê–ù–ò–Æ) -->
                <div class="timer-row-settings" id="timer-settings-panel">
                    <div class="setting-cell">
                        <label>–†–ê–ë–û–¢–ê:</label>
                        <select id="work-time" onchange="updateSettings()"></select>
                    </div>
                    <div class="setting-cell">
                        <label>–û–¢–î–´–•:</label>
                        <select id="break-time" onchange="updateSettings()"></select>
                    </div>
                    <div class="setting-cell">
                        <label>–ë. –û–¢–î–´–•:</label>
                        <select id="long-break-time" onchange="updateSettings()"></select>
                    </div>
                    <div class="setting-cell">
                        <label>–¶–ò–ö–õ–´:</label>
                        <select id="cycles-target" onchange="updateSettings()"></select>
                    </div>
                </div>

                <!-- –°—Ç–∞—Ç—É—Å —Ü–∏–∫–ª–∞ –í–°–ï–ì–î–ê –í–ò–î–ï–ù + ON/OFF AIR -->
                <div class="status-stripe">
                    <div class="status-badge" id="cycle-status">–¶–ò–ö–õ 1 / 4</div>
                    <div class="air-status">
                        <span class="air-dot" id="main-air-dot"></span>
                        <span id="main-air-text">OFF AIR</span>
                    </div>
                </div>
            </div>

            <div class="input-wrapper">
                <div class="input-row">
                    <input type="text" id="task-input" placeholder="–ù–û–í–ê–Ø –ó–ê–î–ê–ß–ê..."
                        onkeydown="if(event.key==='Enter') addTask()">
                    <button class="prepend-btn" id="prepend-toggle" onclick="togglePrependMode()"
                        title="–î–æ–±–∞–≤–∏—Ç—å –≤ –Ω–∞—á–∞–ª–æ —Å–ø–∏—Å–∫–∞">
                        <svg viewBox="0 0 24 24">
                            <path d="M12 19V5M5 12l7-7 7 7" />
                        </svg>
                    </button>
                    <button class="add-btn" onclick="addTask()">+</button>
                </div>
                <!-- –í—ã–±–æ—Ä —Ü–≤–µ—Ç–∞ –¥–ª—è –Ω–æ–≤–æ–π –∑–∞–¥–∞—á–∏ -->
                <div class="new-task-colors">
                    <div class="new-color-opt" style="background:var(--color-grey)" onclick="selectNewColor('grey')"
                        id="new-col-grey"></div>
                    <div class="new-color-opt selected" style="background:var(--color-red)"
                        onclick="selectNewColor('red')" id="new-col-red"></div>
                    <div class="new-color-opt" style="background:var(--color-yellow)" onclick="selectNewColor('yellow')"
                        id="new-col-yellow"></div>
                    <div class="new-color-opt" style="background:var(--color-blue)" onclick="selectNewColor('blue')"
                        id="new-col-blue"></div>
                    <div class="new-color-opt" style="background:var(--color-green)" onclick="selectNewColor('green')"
                        id="new-col-green"></div>
                    <!-- NEW: 5 additional colors -->
                    <div class="new-color-opt" style="background:var(--color-orange)" onclick="selectNewColor('orange')"
                        id="new-col-orange"></div>
                    <div class="new-color-opt" style="background:var(--color-purple)" onclick="selectNewColor('purple')"
                        id="new-col-purple"></div>
                    <div class="new-color-opt" style="background:var(--color-cyan)" onclick="selectNewColor('cyan')"
                        id="new-col-cyan"></div>
                    <div class="new-color-opt" style="background:var(--color-lime)" onclick="selectNewColor('lime')"
                        id="new-col-lime"></div>
                    <div class="new-color-opt" style="background:var(--color-white)" onclick="selectNewColor('white')"
                        id="new-col-white"></div>
                </div>
            </div>

            <div class="list-title">–ê–ö–¢–ò–í–ù–´–ï</div>
            <ul id="active-list"></ul>

            <div id="deferred-section">
                <div class="list-title" style="margin-top: 30px;">–û–¢–õ–û–ñ–ö–ê</div>
                <ul id="deferred-list"></ul>
            </div>

            <div id="completed-section">
                <div class="list-title" style="margin-top: 30px;">–ê–†–•–ò–í</div>
                <ul id="completed-list"></ul>
            </div>
        </div>
    </div>

    <!-- –ú–û–î–ê–õ–ö–ê –ó–ê–ú–ï–¢–û–ö -->
    <div id="notes-modal" class="modal-overlay">
        <div class="modal-box">
            <button class="notes-close-x" onclick="checkNotesClose()">X</button>
            <div class="notes-container">
                <div class="notes-toolbar">
                    <div class="toolbar-row">
                        <button class="toolbar-btn" onclick="formatDoc('bold')" title="–ñ–∏—Ä–Ω—ã–π"><b>B</b></button>
                        <button class="toolbar-btn" onclick="formatDoc('italic')" title="–ö—É—Ä—Å–∏–≤"><i>I</i></button>
                        <button class="toolbar-btn" onclick="formatDoc('underline')"
                            title="–ü–æ–¥—á–µ—Ä–∫–Ω—É—Ç—å"><u>U</u></button>

                        <!-- –ö–Ω–æ–ø–∫–∞ –ß–µ–∫–ª–∏—Å—Ç -->
                        <button class="toolbar-btn" onclick="insertChecklist()" title="–ß–µ–∫–ª–∏—Å—Ç">‚òë</button>

                        <!-- –ö–Ω–æ–ø–∫–∏ –≤—ã—Ä–∞–≤–Ω–∏–≤–∞–Ω–∏—è -->
                        <button class="toolbar-btn" onclick="formatDoc('justifyLeft')" title="–°–ª–µ–≤–∞">
                            <svg viewBox="0 0 24 24">
                                <path
                                    d="M15 15H3v2h12v-2zm0-8H3v2h12V7zM3 13h18v-2H3v2zm0 8h18v-2H3v2zM3 3v2h18V3H3z" />
                            </svg>
                        </button>
                        <button class="toolbar-btn" onclick="formatDoc('justifyCenter')" title="–ü–æ —Ü–µ–Ω—Ç—Ä—É">
                            <svg viewBox="0 0 24 24">
                                <path d="M7 15v2h10v-2H7zm-4 6h18v-2H3v2zm0-8h18v-2H3v2zm4-6v2h10V7H7zM3 3v2h18V3H3z" />
                            </svg>
                        </button>
                        <button class="toolbar-btn" onclick="formatDoc('justifyRight')" title="–°–ø—Ä–∞–≤–∞">
                            <svg viewBox="0 0 24 24">
                                <path d="M3 21h18v-2H3v2zm6-4h12v-2H9v2zm-6-4h18v-2H3v2zm6-4h12V7H9v2zM3 3v2h18V3H3z" />
                            </svg>
                        </button>
                    </div>

                    <div class="toolbar-row">
                        <select class="toolbar-select" onchange="formatDoc('fontName', this.value)">
                            <option value="Courier New">Courier</option>
                            <option value="Arial">Arial</option>
                            <option value="Times New Roman">Times</option>
                        </select>

                        <select class="toolbar-select" onchange="formatDoc('fontSize', this.value)">
                            <option value="3">–ù–æ—Ä–º</option>
                            <option value="5">–ö—Ä—É–ø–Ω–æ</option>
                            <option value="7">–û–≥—Ä–æ–º–Ω–æ</option>
                        </select>

                        <select class="toolbar-select" onchange="formatDoc('foreColor', this.value)">
                            <option value="white">–ë–µ–ª—ã–π</option>
                            <option value="red">–ö—Ä–∞—Å–Ω—ã–π</option>
                            <option value="yellow">–ñ–µ–ª—Ç—ã–π</option>
                            <option value="#888">–°–µ—Ä—ã–π</option>
                        </select>
                    </div>
                </div>

                <!-- –†–µ–¥–∞–∫—Ç–æ—Ä -->
                <div id="notes-editor" contenteditable="true"></div>

                <div class="notes-footer">
                    <button class="modal-btn" onclick="checkNotesClose()">–ó–ê–ö–†–´–¢–¨ –ë–ï–ó –°–û–•–†–ê–ù–ï–ù–ò–Ø</button>
                    <button class="modal-btn primary" onclick="saveNotes()">–°–û–•–†–ê–ù–ò–¢–¨</button>
                </div>
            </div>
        </div>
    </div>

    <!-- –ú–û–î–ê–õ–ö–ê –ù–ê–°–¢–†–û–ï–ö -->
    <div id="settings-modal" class="modal-overlay">
        <div class="modal-box">
            <div class="modal-title">–ù–ê–°–¢–†–û–ô–ö–ò –°–ò–°–¢–ï–ú–´</div>

            <!-- SUPABASE AUTH SECTION -->
            <div class="auth-section" id="auth-section">
                <div class="auth-title">‚ö° –ß–ê–°–¢–û–¢–ê SYNC ‚ö°</div>
                <div class="auth-status" id="auth-status">
                    <span class="status-offline">üî¥ –í–ù–ï –≠–§–ò–†–ê (OFF AIR)</span>
                </div>

                <!-- State: Not Logged In -->
                <div id="auth-login-form" style="display:none;">
                    <input type="email" class="auth-input" id="auth-email" placeholder="–í–í–ï–î–ò–¢–ï –ü–û–ó–´–í–ù–û–ô (EMAIL)">
                    <button class="auth-btn" onclick="sendOTP()">–£–°–¢–ê–ù–û–í–ò–¢–¨ –°–í–Ø–ó–¨</button>
                </div>

                <!-- State: Waiting for Code -->
                <div id="auth-code-form" style="display:none;">
                    <div class="auth-info" id="auth-email-sent">–®–∏—Ñ—Ä–æ–≤–∫–∞ –æ—Ç–ø—Ä–∞–≤–ª–µ–Ω–∞ –Ω–∞ <span id="sent-email"></span>
                    </div>
                    <input type="text" class="auth-input" id="auth-code" placeholder="–ö–û–î –î–û–°–¢–£–ü–ê (6 –¶–ò–§–†)"
                        maxlength="6">
                    <button class="auth-btn" onclick="verifyOTP()">–ü–†–ò–ï–ú (VERIFY)</button>
                </div>

                <!-- State: Logged In -->
                <div id="auth-logged-in" style="display:none;">
                    <div class="auth-user-email" id="auth-user-email"></div>
                    <button class="auth-btn" onclick="logout()">–ö–û–ù–ï–¶ –°–í–Ø–ó–ò (LOGOUT)</button>
                </div>
            </div>

            <div style="color:#aaa; font-size:0.8rem; margin-bottom:10px;">–†–ê–ó–ú–ï–† –®–†–ò–§–¢–ê</div>
            <input type="range" class="range-slider" id="font-size-slider" min="12" max="32" step="1"
                oninput="updateFontSize(this.value)">
            <div style="color:#aaa; font-size:0.8rem; margin:15px 0 5px;">–°–¢–ò–õ–¨ –®–†–ò–§–¢–ê</div>
            <select id="font-family-select" class="font-select" onchange="updateFontFamily(this.value)">
                <option value="'Courier New', Courier, monospace">–°–µ–∫—Ä–µ—Ç–Ω—ã–µ –º–∞—Ç–µ—Ä–∏–∞–ª—ã (Default)</option>
                <option value="'Share Tech Mono', monospace">–¢–µ—Ä–º–∏–Ω–∞–ª –õ–∞–±–æ—Ä–∞—Ç–æ—Ä–∏–∏</option>
                <option value="'Times New Roman', serif">–ì–∞–∑–µ—Ç–Ω–∞—è –í—ã—Ä–µ–∑–∫–∞</option>
                <option value="'Arial Black', sans-serif">–°–æ–≤–µ—Ç—Å–∫–∏–π –ü–ª–∞–∫–∞—Ç</option>
                <option value="'Lucida Console', monospace">–¶–∏—Ñ—Ä–æ–≤–æ–π –ö–æ–¥</option>
            </select>
            <div style="text-align:center; color:#fff; font-size:1.1rem; margin-top:20px;" id="font-preview">–¢–ï–ö–°–¢
                –ü–†–ò–ú–ï–†</div>
            <div class="modal-actions">
                <button class="modal-btn" onclick="closeSettingsModal()">–ó–ê–ö–†–´–¢–¨</button>
            </div>
        </div>
    </div>

    <!-- –ú–û–î–ê–õ–ö–ê –†–ï–î–ê–ö–¢–ò–†–û–í–ê–ù–ò–Ø -->
    <div id="edit-modal" class="modal-overlay">
        <div class="modal-box">
            <div class="modal-title">–†–ï–î–ê–ö–¢–ò–†–û–í–ê–ù–ò–ï</div>
            <textarea id="edit-task-input" class="edit-textarea"></textarea>
            <div style="color:#aaa; font-size:0.8rem; margin-bottom:10px;">–¶–í–ï–¢ –û–ö–ê–ù–¢–û–í–ö–ò</div>
            <div class="color-options">
                <div class="color-opt" style="background:var(--color-grey)" onclick="selectColor('grey')" id="col-grey">
                </div>
                <div class="color-opt" style="background:var(--color-red)" onclick="selectColor('red')" id="col-red">
                </div>
                <div class="color-opt" style="background:var(--color-yellow)" onclick="selectColor('yellow')"
                    id="col-yellow"></div>
                <div class="color-opt" style="background:var(--color-blue)" onclick="selectColor('blue')" id="col-blue">
                </div>
                <div class="color-opt" style="background:var(--color-green)" onclick="selectColor('green')"
                    id="col-green"></div>
                <!-- NEW: 5 additional colors -->
                <div class="color-opt" style="background:var(--color-orange)" onclick="selectColor('orange')"
                    id="col-orange">
                </div>
                <div class="color-opt" style="background:var(--color-purple)" onclick="selectColor('purple')"
                    id="col-purple">
                </div>
                <div class="color-opt" style="background:var(--color-cyan)" onclick="selectColor('cyan')" id="col-cyan">
                </div>
                <div class="color-opt" style="background:var(--color-lime)" onclick="selectColor('lime')" id="col-lime">
                </div>
                <div class="color-opt" style="background:var(--color-white)" onclick="selectColor('white')"
                    id="col-white">
                </div>
            </div>
            <div class="modal-actions">
                <button class="modal-btn" onclick="closeEditModal()">–û–¢–ú–ï–ù–ê</button>
                <button class="modal-btn primary" onclick="saveEditTask()">–°–û–•–†–ê–ù–ò–¢–¨</button>
            </div>
        </div>
    </div>

    <!-- –ú–û–î–ê–õ–ö–ê –£–î–ê–õ–ï–ù–ò–Ø -->
    <div id="delete-modal" class="modal-overlay">
        <div class="modal-box">
            <div class="modal-title" style="font-size: 1.1rem; line-height: 1.4;">–î–ï–ô–°–¢–í–ò–¢–ï–õ–¨–ù–û –•–û–¢–ò–¢–ï –£–î–ê–õ–ò–¢–¨ –ê–ö–¢–ò–í–ù–£–Æ
                –ó–ê–î–ê–ß–£?</div>
            <div class="modal-actions">
                <button class="modal-btn" onclick="closeDeleteModal()">–ù–ï–¢</button>
                <button class="modal-btn primary" onclick="confirmDelete()">–î–ê, –£–ù–ò–ß–¢–û–ñ–ò–¢–¨</button>
            </div>
        </div>
    </div>

    <!-- –ú–û–î–ê–õ–ö–ê –ù–ï–°–û–•–†–ê–ù–ï–ù–ù–´–• –ò–ó–ú–ï–ù–ï–ù–ò–ô -->
    <div id="unsaved-modal" class="modal-overlay">
        <div class="modal-box">
            <div class="modal-title" style="font-size: 1.2rem;">–ï–°–¢–¨ –ù–ï–°–û–•–†–ê–ù–ï–ù–ù–´–ï –ò–ó–ú–ï–ù–ï–ù–ò–Ø</div>
            <div style="color: #ccc; text-align: center; margin-bottom: 20px;">–¢–û–ß–ù–û –í–´–ô–¢–ò?</div>
            <div class="modal-actions">
                <button class="modal-btn" onclick="closeUnsavedModal()">–ù–ï–¢, –û–°–¢–ê–¢–¨–°–Ø</button>
                <button class="modal-btn primary" onclick="confirmCloseNotes()">–î–ê, –í–´–ô–¢–ò</button>
            </div>
        </div>
    </div>

    <!-- –ú–û–î–ê–õ–ö–ê –°–ñ–ò–ì–ê–ù–ò–Ø –ê–†–•–ò–í–ê -->
    <div id="burn-modal" class="modal-overlay">
        <div class="modal-box">
            <div class="modal-title" style="font-size: 1.2rem;">–ü–†–û–¢–û–ö–û–õ: –°–ñ–ò–ì–ê–ù–ò–ï</div>
            <div style="color: #ccc; text-align: center; margin-bottom: 20px; line-height: 1.5;">
                –í–´ –¢–û–ß–ù–û –•–û–¢–ò–¢–ï –£–ù–ò–ß–¢–û–ñ–ò–¢–¨ –í–°–ï –í–´–ü–û–õ–ù–ï–ù–ù–´–ï –ó–ê–î–ê–ß–ò?<br>–≠–¢–û –ù–ï–û–ë–†–ê–¢–ò–ú–û.
            </div>
            <div class="modal-actions">
                <button class="modal-btn" onclick="closeBurnModal()">–û–¢–ú–ï–ù–ê</button>
                <button class="modal-btn primary" onclick="confirmBurnArchive()">–°–ñ–ï–ß–¨</button>
            </div>
        </div>
    </div>

    <!-- –ú–û–î–ê–õ–ö–ê –°–ë–û–Ø –°–í–Ø–ó–ò -->
    <div id="connection-modal" class="modal-overlay">
        <div class="modal-box">
            <div class="modal-title" style="color:var(--red); font-size:1.5rem;">‚ö† –û–®–ò–ë–ö–ê –°–í–Ø–ó–ò –° –¶–ï–ù–¢–†–û–ú</div>
            <div style="color: #ccc; text-align: center; margin: 20px 0; line-height: 1.6;">
                –ù–ï –£–î–ê–õ–û–°–¨ –£–°–¢–ê–ù–û–í–ò–¢–¨ –°–û–ï–î–ò–ù–ï–ù–ò–ï –° –°–ï–†–í–ï–†–û–ú –°–ò–ù–•–†–û–ù–ò–ó–ê–¶–ò–ò.
                <br><br>
                –ü–ï–†–ï–ô–¢–ò –í –ê–í–¢–û–ù–û–ú–ù–´–ô –†–ï–ñ–ò–ú?
            </div>
            <div class="modal-actions" style="flex-direction:column; gap:10px;">
                <button class="modal-btn primary"
                    style="background:var(--red); border-color:var(--red); font-size:1.1rem; color:#fff; text-shadow: 0 0 5px rgba(0,0,0,0.8), 1px 1px 2px rgba(0,0,0,0.9);"
                    onclick="goOfflineMode()">–î–ê, –†–ê–ë–û–¢–ê–¢–¨ –õ–û–ö–ê–õ–¨–ù–û</button>
                <button class="modal-btn" onclick="retryConnection()">–ù–ï–¢, –ü–û–í–¢–û–†–ò–¢–¨ –ü–û–ü–´–¢–ö–£</button>
            </div>
        </div>
    </div>

    <!-- –ú–û–î–ê–õ–ö–ê –ì–û–ù–ì–ê -->
    <div id="alarm-modal" class="modal-overlay">
        <div class="modal-box">
            <div class="modal-title" style="color:var(--red); font-size:1.5rem;">–í–ù–ò–ú–ê–ù–ò–ï</div>
            <div id="alarm-message" class="alarm-msg"></div>
            <div class="modal-actions" style="flex-direction:column; gap:15px;">
                <button class="modal-btn primary" style="font-size:1.2rem; padding:15px;"
                    onclick="continueCycle()">–ü–†–û–î–û–õ–ñ–ò–¢–¨</button>
                <div style="display:flex; gap:10px; width:100%">
                    <button class="modal-btn" onclick="stopGongSound()">–°–¢–û–ü –ó–í–£–ö</button>
                    <button class="modal-btn" style="border-color: #666; color: #aaa;"
                        onclick="endCycleFromModal()">–ó–ê–í–ï–†–®–ò–¢–¨</button>
                </div>
            </div>
        </div>
    </div>

    <!-- –ê–£–î–ò–û (LAZY LOAD - src will be set after init) -->
    <audio id="audio" loop></audio>
    <!-- Silent Loop for iOS Background Timer -->
    <audio id="silence-loop" loop
        src="data:audio/mp3;base64,//OEAAAAAAAAAAAAAAAAAAAAAAAASW5mbwAAAA8AAAAEAAABIADAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMD//////////////////////////////////////////////////////////////////wAAAP//OEAAAAAAAAAAAAAAAAAAAAAAAATGF2YzU4LjEzAAAAAAAAAAAAAAAAAAAAAAAAAAAACCAAAAAAAAABAAAA//OECQAAAAABIAAAAAExBTUUzLjEwMKqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqq//OECQAAAAABIAAAAAExBTUUzLjEwMKqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqq"></audio>
    <audio id="vecna-sfx"></audio>
    <audio id="gong-sfx" loop></audio>

    <!-- Sync Indicator -->
    <div class="sync-indicator" id="sync-indicator">–û–¢–ü–†–ê–í–ö–ê...</div>

    <!-- GLOBAL TASK POPUP -->
    <div id="task-detail-popup" class="task-popup"></div>

    <script src="script.js"></script>
</body>

</html>